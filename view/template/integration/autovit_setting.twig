{{ header }}{{ navigation }}
<main style="margin-top: 58px" class="pt-3">
<div class="container-fluid">
  <div class="text-end">
    <a href="{{ url_authorization }}" class="btn btn-link" data-mdb-ripple-color="dark"><i class="fas fa-home me-2"></i>{{ link_authorization }}</a>
	<span class="btn btn-link text-dark" data-mdb-ripple-color="dark"><i class="fas fa-tools me-2"></i>{{ link_setting }}</span>
	<a href="{{ url_home }}" class="btn btn-link " data-mdb-ripple-color="dark"><i class="fas fa-home me-2"></i>{{ link_home }}</a>
  </div>
  {% if error_warning %}
	<div class="alert alert-dismissible fade show" role="alert" data-mdb-color="danger"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
	  <button type="button" class="btn-close" data-mdb-dismiss="alert" aria-label="Close"></button>
	</div>
  {% endif %}
  {% if success %}
	<div class="alert alert-dismissible fade show" role="alert" data-mdb-color="success"><i class="fa fa-exclamation-circle"></i> {{ success }}
	  <button type="button" class="btn-close" data-mdb-dismiss="alert" aria-label="Close"></button>
	</div>
  {% endif %}
  <form method="POST" action="{{ url_setting }}">
	<div class="d-flex align-items-center mt-3">
		<span class="me-2">+</span>
		<div class="form-outline flex-fill">
		  <input type="number" id="input-price_percent" name="price_percent" value="{{ price_percent }}" class="form-control" />
		  <label class="form-label" for="input-price_percent">{{ entry_price_percent }}</label>
		</div>
		<span class="ms-2">%</span>
	</div>
	<div class="d-flex align-items-center mt-3">
		<span class="me-2">+</span>
		{% if currency.symbol_left %}<span class="me-2">{{ currency.symbol_left }}</span>{% endif %}
		<div class="form-outline flex-fill">
		  <input type="number" step="0.01" id="input-transport_price_fixed" name="transport_price_fixed" value="{{ transport_price_fixed }}" class="form-control" />
		  <label class="form-label" for="input-transport_price_fixed">{{ entry_transport_price_fixed }}</label>
		</div>
		{% if currency.symbol_right %}<span class="ms-2">{{ currency.symbol_right }}</span>{% endif %}
	</div>
	<div class="row">
		<div class="col-12 col-lg-2 mt-3">{{ text_price_by_weight }}</div>
		<div id="container-transport_price_by_weight" class="col-12 col-lg-10">
		  {% set i = 0 %}
		  {% for price in transport_price_by_weight%}
		  <div class="d-flex mt-3">
		    <div class="d-flex flex-fill align-items-center">
				<div class="form-outline flex-fill">
				  <input type="number" step="0.001" name="transport_price_by_weight[{{ i }}][weight_from]" value="{{ price.weight_from }}" class="form-control" />
				  <label class="form-label">{{ entry_from }}</label>
				</div>
				<span class="ms-2 me-2">{{ text_kg }}</span>
			</div>
			<div class="d-flex flex-fill align-items-center">
				<div class="form-outline flex-fill">
				  <input type="number" step="0.001" name="transport_price_by_weight[{{ i }}][weight_to]" value="{{ price.weight_to }}" class="form-control" />
				  <label class="form-label">{{ entry_to }}</label>
				</div>
				<span class="ms-2 me-2">{{ text_kg }}</span>
			</div>
			<div class="d-flex flex-fill align-items-center">
				{% if currency.symbol_left %}<span class="ms-2 me-2">{{ currency.symbol_left }}</span>{% endif %}
				<div class="form-outline flex-fill">
				  <input type="number" step="0.01" name="transport_price_by_weight[{{ i }}][price]" value="{{ price.price }}" class="form-control" />
				  <label class="form-label">{{ entry_price }}</label>
				</div>
				{% if currency.symbol_right %}<span class="ms-2 me-2">{{ currency.symbol_right }}</span>{% endif %}
			</div>
			<div class="d-flex align-items-center delete">
				<button type="button" class="btn btn-link text-danger"><i class="fas fa-times"></i></button>
			</div>
		  </div>
		  {% set i = i + 1 %}
		  {% endfor %}
		  
		  {% if transport_price_by_weight == 0 %}
		  <div class="d-flex mt-3">
		    <div class="d-flex flex-fill align-items-center">
				<div class="form-outline flex-fill">
				  <input type="number" step="0.001" name="transport_price_by_weight[0][weight_from]" value="" class="form-control" />
				  <label class="form-label">{{ entry_from }}</label>
				</div>
				<span class="ms-2 me-2">{{ text_kg }}</span>
			</div>
			<div class="d-flex flex-fill align-items-center">
				<div class="form-outline flex-fill">
				  <input type="number" step="0.001" name="transport_price_by_weight[0][weight_to]" value="" class="form-control" />
				  <label class="form-label">{{ entry_to }}</label>
				</div>
				<span class="ms-2 me-2">{{ text_kg }}</span>
			</div>
			<div class="d-flex flex-fill align-items-center">
				{% if currency.symbol_left %}<span class="ms-2 me-2">{{ currency.symbol_left }}</span>{% endif %}
				<div class="form-outline flex-fill">
				  <input type="number" step="0.01" name="transport_price_by_weight[0][price]" value="" class="form-control" />
				  <label class="form-label">{{ entry_price }}</label>
				</div>
				{% if currency.symbol_right %}<span class="ms-2 me-2">{{ currency.symbol_right }}</span>{% endif %}
			</div>
			<div class="d-flex align-items-center delete">
				<button type="button" class="btn btn-link text-danger"><i class="fas fa-times"></i></button>
			</div>
		  </div>
		  {% set i = 1 %}
		  {% endif %}
		  <div class="text-end mt-3"><button type="button" id="weight-add" class="btn btn-secondary"><i class="fa fa-plus me-2"></i>{{ button_add }}</button></div>
		</div>
	</div>
	<div class="mt-3">
	  <textarea id="input-general_description" name="general_description">{{ general_description }}</textarea>
	</div>
	<button type="submit" class="btn btn-primary ps-5 pe-5 mt-3 mb-3"><i class="fa fa-save me-2"></i>{{ button_save }}</button>
  </form>
</div>
</main>
<script>
$(document).ready(function() {
 $('#input-general_description').summernote({
	height: 175,
	toolbar: false,
	disableDragAndDrop: true,
	tabDisable: true,
	placeholder: '{{ entry_general_description }}',
	callbacks: {
	  onPaste: function(e) {
		var bufferText = ((e.originalEvent || e).clipboardData || window.clipboardData).getData('Text');
		e.preventDefault();
		setTimeout( function(){
		  document.execCommand( 'insertText', false, bufferText );
		}, 10 );
	  }
	}
  });
});

let i = {{ i }};
$('#weight-add').click(function() {
  let html = '';
	html += '<div class="d-flex mt-3">';
		html += '<div class="d-flex flex-fill align-items-center">';
			html += '<div class="form-outline flex-fill">';
				html += '<input type="number" step="0.001" name="transport_price_by_weight['+i+'][weight_from]" value="" class="form-control" />';
				html += '<label class="form-label">{{ entry_from }}</label>';
			html += '</div>';
			html += '<span class="ms-2 me-2">{{ text_kg }}</span>';
		html += '</div>';
		html += '<div class="d-flex flex-fill align-items-center">';
			html += '<div class="form-outline flex-fill">';
				html += '<input type="number" step="0.001" name="transport_price_by_weight['+i+'][weight_to]" value="" class="form-control" />';
				html += '<label class="form-label">{{ entry_to }}</label>';
			html += '</div>';
			html += '<span class="ms-2 me-2">{{ text_kg }}</span>';
		html += '</div>';
		html += '<div class="d-flex flex-fill align-items-center">';
			html += '{% if currency.symbol_left %}<span class="ms-2 me-2">{{ currency.symbol_left }}</span>{% endif %}';
			html += '<div class="form-outline flex-fill">';
				html += '<input type="number" step="0.01" name="transport_price_by_weight['+i+'][price]" value="" class="form-control" />';
				html += '<label class="form-label">{{ entry_price }}</label>';
			html += '</div>';
			html += '{% if currency.symbol_right %}<span class="ms-2 me-2">{{ currency.symbol_right }}</span>{% endif %}';
		html += '</div>';
		html += '<div class="d-flex align-items-center delete">';
			html += '<button type="button" class="btn btn-link text-danger"><i class="fas fa-times"></i></button>';
		html += '</div>';
	html += '</div>';
	
  $('#weight-add').parent().before(html);
  i++;
  
  document.querySelectorAll('.form-outline').forEach((formOutline) => {
	new mdb.Input(formOutline).init();
  });
});

$('#container-transport_price_by_weight').delegate('.delete', 'click', function() {
  $(this).parent().remove();
});
</script>
{{ footer }} 
