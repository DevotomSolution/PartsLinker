{{ header }}{{ navigation }}
<!--Main layout-->
<main style="margin-top: 58px" class="pt-3">
  <div class="container-fluid">
	{% if success %}
	  <div class="alert alert-dismissible fade show" role="alert" data-mdb-color="success"><i class="fa fa-exclamation-circle"></i> {{ success }}
		<button type="button" class="btn-close" data-mdb-dismiss="alert" aria-label="Close"></button>
	  </div>
	{% endif %}
	<div class="d-flex flex-wrap align-items-center">
	  <div class="flex-fill d-flex align-items-center">
		<div class="flex-fill d-none d-md-block position-relative me-3">
		  <div id="search" class="form-outline">
			<input type="text" name="search" value="{{ search }}" class="form-control" />
			<label class="form-label">{{ text_search }}</label>
		  </div>
		  <button type="button" id="btn-search" class="btn btn-outline-primary fs-7 border-0 position-absolute ps-3 pe-3 h-100" style="top: 0; right: 0;" data-mdb-color="dark"><i class="fas fa-search"></i></button>
		</div>
	  </div>
	  <div><a href="{{ add }}" class="btn btn-primary"><i class="fas fa-plus"></i><span class="ms-2">{{ button_add }}</span></a></div>
	</div>
	<div class="mt-3">
	  <table class="table table-sm">
	  {% for category in categories %}
		<tr>
		  <td><a href="{{ category.edit }}">{{ category.path }}<i class="fas fa-pen ms-3"></i></a></td>
		  <td class="text-end"><button type="button" class="btn btn-danger btn-sm btn-delete" data-category_id="{{ category.category_id }}"><i class="fas fa-trash"></i></button></td>
		</tr>
	  {% endfor %}
	  </table>
	</div>
	<div class="row mt-3">
	  <div class="col-sm-6 text-start">{{ pagination }}</div>
	  <div class="col-sm-6 text-end">{{ results }}</div>
	</div>
  </div>
</main>
<script>
$('.btn-delete').click(function(e) {
  let data = {};
  data.category_id = e.currentTarget.getAttribute('data-category_id');
  
  answear = confirm('{{ text_confirm_delete }}');
  
  if (!answear) {
    return;
  }

  $.ajax({
	url: '{{ server }}index.php?route=admin/tool/category.delete&user_token={{ user_token }}',
	method: 'POST',
	data: data,
	dataType: 'json',
  }).done(function(json) {
    location.reload();
  });
});

$('#btn-search').on('click', function() {
  let url = '';

  let search = $('input[name=\'search\']').val();

  if (search) {
	url += '&search=' + encodeURIComponent(search);
  }
	
  location = '{{ action }}' + url;
});

$('input[name=\'search\']').keydown(function(e) {
  if(e.keyCode == 13) {
	$('#btn-search').trigger('click');
  }
});
</script>
{{ footer }}