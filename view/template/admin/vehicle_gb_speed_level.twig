{{ header }}{{ navigation }}
<!--Main layout-->
<main style="margin-top: 58px" class="pt-3">
  <div class="container-fluid">
	{% if error_warning %}
	  <div class="alert alert-dismissible fade show" role="alert" data-mdb-color="danger"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
		<button type="button" class="btn-close" data-mdb-dismiss="alert" aria-label="Close"></button>
	  </div>
	{% endif %}
	{% if success %}
	  <div class="alert alert-dismissible fade show" role="alert" data-mdb-color="success"><i class="fa fa-exclamation-circle"></i> {{ success }}
		<button type="button" class="btn-close" data-mdb-dismiss="alert" aria-label="Close"></button>
	  </div>
	{% endif %}
	<div class="form-outline mb-2">
	  <input type="number" name="gb_speed_level_text" id="gb_speed_level" class="form-control" />
	  <label class="form-label" for="gb_speed_level">{{ text_gb_speed_level }}</label>
	</div>
	<div class="text-end"><button type="button" id="add" class="btn btn-primary"><i class="fas fa-plus me-2"></i>{{ button_add }}</button></div>
	<div id="gb_speed_levels" class="mt-3">
	  {% for gb_speed_level in vehicle_gb_speed_levels %}
	  <div class="chip me-0">{{ gb_speed_level.text }}<i id="{{ gb_speed_level.vehicle_gb_speed_level_id }}" class="close fas fa-times"></i></div>
	  {% endfor%}
	</div>
  </div>
</main>
<script>
closeInit();

$('#add').click(function() {
  let data = {};
  data.gb_speed_level_text = $('#gb_speed_level').val();
  
  $.ajax({  
	url: '{{ server }}index.php?route=admin/vehicle/gb_speed_level.add&user_token={{ user_token }}',
	method: 'POST',
	data: data,
	dataType: 'json'
  }).done(function(json) {
    if(json['gb_speed_level_id'] !== undefined) {
	  $('#gb_speed_levels').append('<div class="chip me-0">'+json['text']+'<i id="'+json['gb_speed_level_id']+'" class="close fas fa-times"></i></div>');
	  $('#gb_speed_level').val('');
	  closeInit();
	}
  });
});


function closeInit() {
  $('.close').click(function(e) {
	$.ajax({
	  url: '{{ server }}index.php?route=admin/vehicle/gb_speed_level.remove&user_token={{ user_token }}&gb_speed_level_id=' + encodeURIComponent(e.target.id),
	});
	
	e.target.parentElement.remove();
  });
}
</script>
{{ footer }}